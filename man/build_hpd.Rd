% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build-hpd.R
\name{build_hpd}
\alias{build_hpd}
\title{Build HPD polygons for continuous phylogeography}
\usage{
build_hpd(
  treedata,
  level = "0.80",
  lon = "location1",
  lat = "location2",
  height = "height_median",
  most_recent_sample = NULL,
  debug = getOption("ggphylogeo.debug", FALSE)
)
}
\arguments{
\item{treedata}{treedata object with phylogeographic annotations from
\code{treeio::read.beast()}}

\item{level}{character HPD level to use (e.g. "0.80" for 80\% HPD)}

\item{lon}{name of longitude coordinate column prefix (default: "location1")}

\item{lat}{name of latitude coordinate column prefix (default: "location2")}

\item{height}{column name for node ages (default: "height_median")}

\item{most_recent_sample}{Date, numeric year, or "YYYY-MM-DD" string for
calibrating ages to real dates. If NULL, ages remain as numeric heights.}

\item{debug}{logical; emit debug messages}
}
\value{
A data.frame with columns: node, polygon, lon, lat, age, group;
or NULL if no valid HPD polygons found.
}
\description{
Extracts highest posterior density (HPD) uncertainty regions from a BEAST
continuous phylogeographic analysis. Each node may have multiple HPD polygons
representing the spatial uncertainty of its location estimate.
}
