<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ggplot2 Tools for Continuous Phylogeography • ggphylogeo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="ggplot2 Tools for Continuous Phylogeography">
<meta property="og:description" content="Visualization tools for BEAST continuous phylogeographic analyses using ggplot2. Provides functions to build and plot branch segments, HPD polygons, and nodes from treedata objects. Includes an interactive Shiny application for exploring phylogeographic data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ggphylogeo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/continuous-phylogeography.html">Continuous phylogeography with ggphylogeo</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Joon-Klaps/ggphylogeo/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="ggphylogeo">ggphylogeo<a class="anchor" aria-label="anchor" href="#ggphylogeo"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>ggplot2 extensions for visualising continuous phylogeographic reconstructions from BEAST.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Joon-Klaps/ggphylogeo"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li>
<strong>Quick visualization</strong> with <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> for immediate results</li>
<li>
<strong>Component-based plotting</strong> with individual geoms for full customization</li>
<li>
<strong>Interactive exploration</strong> with Shiny app</li>
<li>
<strong>Animation support</strong> for temporal visualization</li>
<li>
<strong>Non-geographic data</strong> support (e.g., antigenic cartography)</li>
</ul>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>Visualize a BEAST MCC tree immediately with <code>autoplot</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Joon-Klaps/ggphylogeo" class="external-link">ggphylogeo</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load bundled example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yfv_tree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Basic plot with date calibration</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">yfv_tree</span>, most_recent_sample <span class="op">=</span> <span class="st">"2017-04-22"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="inst/extras/yfv.png" alt="YFV phylogeography"><div class="figcaption">YFV phylogeography</div>
</div>
</div>
<div class="section level2">
<h2 id="detailed-plotting">Detailed Plotting<a class="anchor" aria-label="anchor" href="#detailed-plotting"></a>
</h2>
<p>For custom visualizations, build plots layer by layer using the three main geoms:</p>
<ul>
<li>
<code><a href="reference/geom_phylo_branches.html">geom_phylo_branches()</a></code> - Plot tree branches as curves</li>
<li>
<code><a href="reference/geom_phylo_hpd.html">geom_phylo_hpd()</a></code> - Plot uncertainty regions (HPD polygons)</li>
<li>
<code><a href="reference/geom_phylo_nodes.html">geom_phylo_nodes()</a></code> - Plot nodes and tips</li>
</ul>
<p>The <code><a href="reference/build_phylogeo.html">build_phylogeo()</a></code> function prepares the data for plotting, returning <code>branches</code>, <code>nodes</code>, and <code>hpd</code> data frames (as well as <code>viewbox</code> to set map limits).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Joon-Klaps/ggphylogeo" class="external-link">ggphylogeo</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wnv_tree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract phylogeographic components</span></span>
<span><span class="va">pgeo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_phylogeo.html">build_phylogeo</a></span><span class="op">(</span><span class="va">wnv_tree</span>, most_recent_sample <span class="op">=</span> <span class="st">"2007-07-01"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build custom plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html" class="external-link">map_data</a></span><span class="op">(</span><span class="st">"world"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"lightgray"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_phylo_hpd.html">geom_phylo_hpd</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">hpd</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_phylo_branches.html">geom_phylo_branches</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">branches</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_phylo_nodes.html">geom_phylo_nodes</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">nodes</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>    labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"%Y"</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1997-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2008-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"2 year"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">viewbox</span><span class="op">$</span><span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">viewbox</span><span class="op">$</span><span class="va">ylim</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/theme_phylogeo.html">theme_phylogeo</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/guides_phylogeo.html">guides_phylogeo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="inst/extras/wnv_animation.gif" alt="WNV phylogeography"><div class="figcaption">WNV phylogeography</div>
</div>
</div>
<div class="section level2">
<h2 id="non-geographic-data">Non-Geographic Data<a class="anchor" aria-label="anchor" href="#non-geographic-data"></a>
</h2>
<p>The package also works with continuous trait data that isn’t geographic. For example, visualizing antigenic cartography:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Joon-Klaps/ggphylogeo" class="external-link">ggphylogeo</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load H3N2 antigenic data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">h3n2_tree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use antigenic dimensions instead of geographic coordinates</span></span>
<span><span class="va">pgeo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_phylogeo.html">build_phylogeo</a></span><span class="op">(</span><span class="va">h3n2_tree</span>, lon <span class="op">=</span> <span class="st">"antigenic1"</span>, lat <span class="op">=</span> <span class="st">"antigenic2"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_phylo_hpd.html">geom_phylo_hpd</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">hpd</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, smooth <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_phylo_branches.html">geom_phylo_branches</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">branches</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_phylo_nodes.html">geom_phylo_nodes</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">nodes</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Antigenic value"</span>, direction <span class="op">=</span> <span class="fl">1</span>, option <span class="op">=</span> <span class="st">"plasma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/theme_phylogeo.html">theme_phylogeo</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/guides_phylogeo.html">guides_phylogeo</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Antigenic Dimension 1"</span>, y <span class="op">=</span> <span class="st">"Antigenic Dimension 2"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="inst/extras/h3n2.png" alt="H3N2 antigenic cartography"><div class="figcaption">H3N2 antigenic cartography</div>
</div>
</div>
<div class="section level2">
<h2 id="animation">Animation<a class="anchor" aria-label="anchor" href="#animation"></a>
</h2>
<p>Create animated visualizations showing temporal progression:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Joon-Klaps/ggphylogeo" class="external-link">ggphylogeo</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com" class="external-link">gganimate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wnv_tree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create animation with autoplot</span></span>
<span><span class="va">anim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span></span>
<span>  <span class="va">wnv_tree</span>,</span>
<span>  most_recent_sample <span class="op">=</span> <span class="st">"2007-07-01"</span>,</span>
<span>  animate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nframes <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  show_dispersion_legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save animation</span></span>
<span><span class="fu"><a href="https://gganimate.com/reference/anim_save.html" class="external-link">anim_save</a></span><span class="op">(</span><span class="st">"wnv_animation.gif"</span>, animation <span class="op">=</span> <span class="va">anim</span><span class="op">)</span></span></code></pre></div>
<p>Or build animations manually for full control:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pgeo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_phylogeo.html">build_phylogeo</a></span><span class="op">(</span><span class="va">wnv_tree</span>, most_recent_sample <span class="op">=</span> <span class="st">"2007-07-01"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html" class="external-link">map_data</a></span><span class="op">(</span><span class="st">"world"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"lightgray"</span>, color <span class="op">=</span> <span class="st">"white"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_phylo_hpd.html">geom_phylo_hpd</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">hpd</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, smooth <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_phylo_branches.html">geom_phylo_branches</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">branches</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Year"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/theme_phylogeo.html">theme_phylogeo</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">viewbox</span><span class="op">$</span><span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">pgeo</span><span class="op">$</span><span class="va">viewbox</span><span class="op">$</span><span class="va">ylim</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">gganimate</span><span class="fu">::</span><span class="fu"><a href="https://gganimate.com/reference/transition_reveal.html" class="external-link">transition_reveal</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Date: {format(as.Date(frame_along, origin='1970-01-01'), '%Y')}"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">anim</span> <span class="op">&lt;-</span> <span class="fu">gganimate</span><span class="fu">::</span><span class="fu"><a href="https://gganimate.com/reference/animate.html" class="external-link">animate</a></span><span class="op">(</span><span class="va">p</span>, nframes <span class="op">=</span> <span class="fl">400</span>, fps <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://gganimate.com/reference/anim_save.html" class="external-link">anim_save</a></span><span class="op">(</span><span class="st">"wnv_animation_manual.gif"</span>, animation <span class="op">=</span> <span class="va">anim</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interactive-shiny-app">Interactive Shiny App<a class="anchor" aria-label="anchor" href="#interactive-shiny-app"></a>
</h2>
<p>Explore phylogeographic data interactively:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Joon-Klaps/ggphylogeo" class="external-link">ggphylogeo</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wnv_tree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Launch interactive viewer</span></span>
<span><span class="fu"><a href="reference/run_phylogeo_app.html">run_phylogeo_app</a></span><span class="op">(</span><span class="va">wnv_tree</span>, most_recent_sample <span class="op">=</span> <span class="st">"2007-07-01"</span><span class="op">)</span></span></code></pre></div>
<p>The Shiny app provides:</p>
<ul>
<li>Toggle visibility of HPD polygons, branches, and nodes</li>
<li>Highlight specific tips</li>
<li>Adjust node sizes</li>
<li>Interactive zooming and panning</li>
</ul>
</div>
<div class="section level2">
<h2 id="bundled-datasets">Bundled Datasets<a class="anchor" aria-label="anchor" href="#bundled-datasets"></a>
</h2>
<p>The package includes example BEAST MCC trees:</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="47%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th>Dataset</th>
<th>Description</th>
<th>Use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>wnv_tree</code></td>
<td>West Nile Virus, North America</td>
<td>Geographic phylogeography</td>
</tr>
<tr class="even">
<td><code>yfv_tree</code></td>
<td>Yellow Fever Virus, South America</td>
<td>Geographic phylogeography</td>
</tr>
<tr class="odd">
<td><code>hiv1_tree</code></td>
<td>HIV-1 subtype G</td>
<td>Geographic phylogeography</td>
</tr>
<tr class="even">
<td><code>h3n2_tree</code></td>
<td>H3N2 Influenza</td>
<td>Antigenic cartography</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load any bundled dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wnv_tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yfv_tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hiv1_tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">h3n2_tree</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributing--development">Contributing &amp; Development<a class="anchor" aria-label="anchor" href="#contributing--development"></a>
</h2>
<p>Contributions are welcome! Please fork the repository and submit a pull request.</p>
<div class="section level3">
<h3 id="development-setup">Development Setup<a class="anchor" aria-label="anchor" href="#development-setup"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load all functions during development</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">load_all</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run tests</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check package</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">check</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build package</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">build</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tested-environment">Tested Environment<a class="anchor" aria-label="anchor" href="#tested-environment"></a>
</h3>
<p>This package was developed and tested with:</p>
<ul>
<li>R 4.4.3</li>
<li>ggplot2 4.0.1</li>
<li>treeio 1.30.0</li>
<li>sf 1.0-24</li>
<li>smoothr 1.2.1</li>
<li>gganimate 1.0.11</li>
<li>shiny 1.12.1</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT License - see <a href="LICENSE">LICENSE</a> for details.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Joon-Klaps/ggphylogeo/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Joon-Klaps/ggphylogeo/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggphylogeo</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Joon Klaps <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Joon-Klaps/ggphylogeo/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Joon-Klaps/ggphylogeo/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Joon Klaps.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
